---
title: "ðŸŽ¨ Selection Bias & Missing Data Challenge"
subtitle: "Creating a Statistics Meme: Write Your Own Functions"
format:
  html: default
execute:
  echo: false
  eval: true
  warning: false
  message: false
---


```{python}
#| label: step1-prepare
#| echo: false
#| warning: false
#| message: false
#| include: false

import numpy as np
import matplotlib.pyplot as plt
import sys
import io
from contextlib import redirect_stdout
from step1_prepare_image import prepare_image

# Load and prepare the image
# CHANGE THIS to use your own image!
img_path = 'ramverma.jpg'  # Example image - replace with your own image
with redirect_stdout(io.StringIO()):
    gray_image = prepare_image(img_path, max_size=512)
```


```{python}
#| label: step2-stipple
#| echo: false
#| warning: false
#| message: false
#| include: false

from step2_create_stipple import create_stipple

# Create stippled image
with redirect_stdout(io.StringIO()):
    stipple_pattern, samples = create_stipple(
        gray_image,
        percentage=0.08,  # 8% of pixels will be stippled
        sigma=0.9,  # Repulsion radius
        content_bias=0.9,  # Strongly follow importance map
        noise_scale_factor=0.1,  # Moderate exploration
        extreme_downweight=0.5,  # Moderate downweighting of extremes
        extreme_threshold_low=0.2,  # Downweight tones below 0.2
        extreme_threshold_high=0.8,  # Downweight tones above 0.8
        extreme_sigma=0.1  # Smooth transition width
    )
```



```{python}
#| label: step3-tonal
#| echo: false
#| warning: false
#| message: false
#| include: false

from step3_create_tonal import create_tonal

# Create tonal analysis with a 16Ã—12 grid
grid_rows = 16
grid_cols = 12
with redirect_stdout(io.StringIO()):
    tonal_image, average_tones, tonal_stats = create_tonal(
        gray_image,
        grid_rows=grid_rows,
        grid_cols=grid_cols,
        return_full_image=True
    )
```


```{python}
#| label: step4-block-letter
#| echo: false
#| warning: false
#| message: false
#| include: false

from step4_create_block_letter import create_block_letter_s

# Get image dimensions
h, w = gray_image.shape

# Create block letter S
with redirect_stdout(io.StringIO()):
    block_letter = create_block_letter_s(h, w, letter="S", font_size_ratio=0.9)
```


```{python}
#| label: step5-masked
#| echo: false
#| warning: false
#| message: false
#| include: false

from step5_create_masked import create_masked_stipple

# Create masked stippled image
with redirect_stdout(io.StringIO()):
    masked_stipple = create_masked_stipple(
        stipple_pattern,
        block_letter,
        threshold=0.5  # Pixels below 0.5 are considered part of the mask
    )
```



```{python}
#| label: create-final-meme
#| echo: false
#| warning: false
#| message: false
#| include: false

from create_meme import create_statistics_meme

# Create the final meme
with redirect_stdout(io.StringIO()):
    create_statistics_meme(
        original_img=gray_image,
        stipple_img=stipple_pattern,
        block_letter_img=block_letter,
        masked_stipple_img=masked_stipple,
        output_path="my_statistics_meme.png",
        dpi=150,
        background_color="white"
    )
```



```{python}
#| label: final-meme
#| echo: false
#| eval: false
#| fig-cap: "Statistics meme demonstrating selection bias"

# Your code to create and display the meme goes here
# (all the steps above, uncommented and working)

# Display the final meme
 from IPython.display import Image, display
 display(Image("my_statistics_meme.png"))
```


## My Selection Bias Meme

Here's the completed statistics meme demonstrating selection bias:

![Selection Bias Meme: Four panels showing Reality, Your Model, Selection Bias, and Estimate](my_statistics_meme.png)

**Explanation: How missing data can create misleading patterns in data.** This meme illustrates how selection bias creates false patterns in data. The original image represents reality, the stippled version shows our data sample, and when we systematically remove data points in an "S" pattern (selection bias), the resulting estimate becomes distortedâ€”demonstrating how missing data that isn't random can lead to completely misleading conclusions in statistical analysis.

